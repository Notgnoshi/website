{% load pygmentify_tags %}
<!doctype HTML>
<html>
{% include "includes/head.html" %}

<body>
    {% include "includes/header.html" %}

    <div class="page-content">
        <div class="wrap">
            <p>I end up installing and reinstalling Ubuntu <em>a lot</em>. As with many Linux users, I cannot
                <em>not</em> customize my installation. However, I use multiple devices with several accounts, some of
                which are not managed by me. This leads to a massive headache when trying to keep customizations in
                sync, especially when they keep changing as I learn new things.</p>
            <p>This page is an attempt to consolidate all of my notes and helper scripts into the same place.</p>

            <ul>
                <li><a href="#installation">Installation</a></li>
                <ul>
                    <li><a href="#live-disk">Creating the Startup Disk</a></li>
                    <li><a href="#installing">Installing Ubuntu</a></li>
                </ul>
                <li><a href="#first-steps">First Steps</a></li>
                <ul>
                    <li><a href="#bootstrap-software">Bootstrap Software</a></li>
                    <li><a href="#ssh-keys">SSH Keys</a></li>
                    <li><a href="#dotfiles">Dotfiles</a></li>
                </ul>
                <li><a href="#configuration">Configuration</a></li>
                <ul>
                    <li><a href="#sdsmt">School VPN and Network Drives</a></li>
                </ul>
            </ul>

            <h1 id="installation">Installation</h1>
            <p>Actually installing Ubuntu is a very simple task. The folks at Canonical have put extraordinary amounts
                of effort to make installing Ubuntu both fast and simple.</p>
            <h3 id="live-disk">Creating the Startup Disk</h3>
            <p>I only mention this because it has changed in recent years. You used to have to use <a
                    href="https://unetbootin.github.io/">UNetbootin</a> to create a live USB from an ISO image. Nowadays
                you can use the builtin Startup Disk Creator to flash an ISO image to a USB drive. There's no need to
                install additional software, or run anything with <code>sudo</code>.</p>

            <img class="centered" src="/static/images/ubuntu-configuration/startup-disk-creator.png">

            <p>Select the ISO and USB drive you wish to flash, and click "Make Startup Disk". It will take some time,
                but is otherwise painless.</p>
            <p>Note that the USB drive chosen may make a difference. I have learned that whenever I try to install from
                an image flashed to one of <a href="http://a.co/d/94snmEr">these</a> flash drives, I get hit by <a
                    href="https://bugs.launchpad.net/ubuntu/+source/ubiquity/+bug/658865">this nasty bug</a>. In short,
                the fix is to select "Try Ubuntu without installing" when prompted, and then delete
                <code>/usr/lib/ubiquity/apt-setup/generators/40cdrom</code> before running the installer.</p>
            <p>Additionally, depending on the device I am installing Ubuntu on, there are some fixes that must be done
                before Ubuntu will install successfully.</p>
            <p><del>On my Dell XPS 15 9560, I need to follow the instructions provided in this <a
                        href="https://askubuntu.com/a/989707">answer</a> and install the Nvidia drivers before it will
                    boot. On my piecemeal desktop, I need to boot from a USB 2.0 port as discussed <a
                        href="https://askubuntu.com/a/26864">here</a>.</del>These steps are no longer necessary as of
                Ubuntu 19.04.</p>
            <h3 id="installing">Installing Ubuntu</h3>
            <p>This is a straightforward matter. The only thing worth mentioning is the installation type. You have
                several choices:</p>

            <img class="centered" src="/static/images/ubuntu-configuration/partition-settings.png">

            <p>My choice depends on the device I am installing Ubuntu on. On several, I dual boot with other operating
                systems. On some, I use only Ubuntu. Your mileage may vary. Make sure to backup your data regardless of
                your choice.</p>
            <h1 id="first-steps">First Steps</h1>
            <h3 id="bootstrap-software">Bootstrap Software</h3>
            <p>Before anything else can be done, I need <code>vim</code>, <code>git</code>, and <code>curl</code></p>
            <!-- TODO: Find a way to make this indentable. -->
            {% pygmentify %}
            <pre class="shell">
sudo apt install vim git curl
</pre>
            {% endpygmentify %}
            <h3 id="ssh-keys">SSH Keys</h3>
            <p>Before I can clone my <a href="https://github.com/Notgnoshi/dotfiles">dotfiles</a> repository, I need to
                set up new SSH keys for <a href="https://github.com/settings/ssh/new">GitHub</a>.</p>
            {% pygmentify %}
            <pre class="shell">
mkdir -p ~/.ssh
ssh-keygen -t rsa -b 4096 -f ~/.ssh/git
echo "AddKeysToAgent yes

Host github.com
    IdentityFile ~/.ssh/git

Host git.agill.xyz
    IdentityFile ~/.ssh/git

Host gitlab.mcs.sdsmt.edu
    IdentityFile ~/.ssh/git

Host anguish
    IdentityFile ~/.ssh/anguish

Host limbo
    IdentityFile ~/.ssh/limbo

Host agill.xyz
    IdentityFile ~/.ssh/limbo

Host linux103
    HostName linux103.mcs.sdsmt.edu
    User xxxxxxx
    IdentityFile ~/.ssh/opplab" > ~/.ssh/config
</pre>
            {% endpygmentify %}
            <p>And then add the SSH keys to the proper accounts.</p>
            <h3 id="dotfiles">Dotfiles</h3>
            <p>Then I clone my dotfiles repository to <code>~/.config/dotfiles/</code> and symlink each of the dotfiles
                so that I don't have a git repository in my home folder.</p>
            {% pygmentify %}
            <pre class="shell">
git clone --recurse=submodules git@github.com:Notgnoshi/dotfiles.git ~/.config/dotfiles
~/.config/dotfiles/deploy.py ~
# Answer 'y' to 'Update dotfiles and plugins...' prompt
# Answer 'y' to 'Install fzf?' prompt
~/bin/configure.sh
source ~/.bashrc
</pre>
            {% endpygmentify %}
            <h1 id="configuration">Configuration</h1>
            <h3 id="sdsmt">School VPN and Network Drives</h3>
            <p><del>Follow the instructions <a href="https://www.mcs.sdsmt.edu/lpyeatt/VPN/index/"
                        target="_blank">here</a>
                    to connect to the school VPN.</del> Using SSTP is currently quite difficult on Ubuntu 19.04 right
                now, and the linked website does not provide details for using VPNC.</p>
            {% pygmentify %}
            <pre class="shell">
sudo apt install network-manager-vpnc-gnome
</pre>
            {% endpygmentify %}
            <p>Then create a new VPNC connection in <code>network-manager</code>.</p>
            <img class="centered" src="/static/images/ubuntu-configuration/vpn-vpnc-choice.png">
            <p>Enter the following information. The username is your student ID, and the password is your student password.</p>
            <img class="centered" src="/static/images/ubuntu-configuration/vpn-vpnc-settings.png">
            <p>Then to connect to the shared F Drive, connect to a server in Nautilus with the address
                <code>smb://speedy.sdsmt.edu/sdsmtshare/</code>. When you click "connect", you will need to enter your
                username and password (the same as for the VPN).</p>
            <img class="centered" src="/static/images/ubuntu-configuration/f-drive.png">
            <p>To connect to your personal H Drive, the address is <code>smb://speedy.sdsmt.edu/student_id$/</code>
                (note the <code>$</code>!)</p>
        </div>
    </div>

    {% include "includes/footer.html" %}
</body>

</html>
